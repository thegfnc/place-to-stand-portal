# Task 5.9: Privacy & Retention (Emails & Attachments)

## Overview

Establish privacy and retention policies for raw emails and attachments, including erasure workflows and logging redaction.

## Dependencies

- 5.1 (Threads & Messages Schema)
- 5.7 (Attachments & Storage Policy)

## Deliverables

1) Retention

- Raw `.eml` retention: configurable (e.g., 12–24 months) via env; keep summaries/classifications indefinitely unless client is deleted.
- Scheduled job to purge Storage objects older than retention window where not on legal hold; keep DB minimal pointers or soft-delete rows.

2) Erasure workflow

- Admin action to “Erase message content” that deletes Storage objects and clears `body_text` while maintaining audit metadata (timestamps, ids).
- Ensure identity links and threads remain consistent after erasure.

3) Logging & PII

- Redact email bodies, headers, and addresses in logs; log only stable ids and minimal context.
- Sentry breadcrumbs include event types and ids only.

## Acceptance Criteria

- Documented, configurable retention policy applied through a scheduled task.
- Erasure action exists and ensures Storage + DB alignment.

## Files Changed

- `lib/jobs/retention.ts` (new) – scheduled purge logic (docs scope)
- `docs` only for this task; code added in later implementation tasks

